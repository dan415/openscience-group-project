<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main" xml:id="_C2Chx3j">DO DEEP GENERATIVE MODELS KNOW WHAT THEY DON&apos;T KNOW?</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2019-02-24">24 Feb 2019</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName coords="1,113.98,137.54,60.61,8.96;1,174.59,136.03,1.23,6.12"><forename type="first">Eric</forename><surname>Nalisnick</surname></persName>
							<email>e.nalisnick@eng.cam.ac.uk</email>
						</author>
						<author>
							<persName coords="1,182.06,137.54,82.60,8.96"><forename type="first">Akihiro</forename><surname>Matsukawa</surname></persName>
						</author>
						<author>
							<persName coords="1,272.38,137.54,58.21,8.96"><forename type="first">Yee</forename><forename type="middle">Whye</forename><surname>Teh</surname></persName>
						</author>
						<author>
							<persName coords="1,337.63,137.54,49.65,8.96"><forename type="first">Dilan</forename><surname>Gorur</surname></persName>
						</author>
						<author>
							<persName coords="1,394.55,137.54,111.55,8.96;1,506.10,136.03,1.36,6.12"><forename type="first">Balaji</forename><surname>Lakshminarayanan</surname></persName>
							<email>balajiln@google.com</email>
						</author>
						<author>
							<persName coords="1,113.98,148.89,42.61,8.64"><surname>Deepmind</surname></persName>
						</author>
						<title level="a" type="main" xml:id="_hDPReXp">DO DEEP GENERATIVE MODELS KNOW WHAT THEY DON&apos;T KNOW?</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2019-02-24">24 Feb 2019</date>
						</imprint>
					</monogr>
					<idno type="MD5">5CBB36587760BBFF6C1391A3F2A249C2</idno>
					<idno type="arXiv">arXiv:1810.09136v3[stat.ML]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2" ident="GROBID" when="2023-05-12T20:42+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0" xml:id="_v7DDNPP"><p xml:id="_YmGcZge">A neural network deployed in the wild may be asked to make predictions for inputs that were drawn from a different distribution than that of the training data. A plethora of work has demonstrated that it is easy to find or synthesize inputs for which a neural network is highly confident yet wrong. Generative models are widely viewed to be robust to such mistaken confidence as modeling the density of the input features can be used to detect novel, out-of-distribution inputs. In this paper we challenge this assumption. We find that the density learned by flow-based models, VAEs, and PixelCNNs cannot distinguish images of common objects such as dogs, trucks, and horses (i.e. CIFAR-10) from those of house numbers (i.e. SVHN), assigning a higher likelihood to the latter when the model is trained on the former. Moreover, we find evidence of this phenomenon when pairing several popular image data sets: FashionMNIST vs MNIST, CelebA vs SVHN, ImageNet vs CIFAR-10 / CIFAR-100 / SVHN. To investigate this curious behavior, we focus analysis on flow-based generative models in particular since they are trained and evaluated via the exact marginal likelihood. We find such behavior persists even when we restrict the flows to constant-volume transformations. These transformations admit some theoretical analysis, and we show that the difference in likelihoods can be explained by the location and variances of the data and the model curvature. Our results caution against using the density estimates from deep generative models to identify inputs similar to the training distribution until their behavior for out-of-distribution inputs is better understood.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<facsimile>
		<surface n="1" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="2" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="3" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="4" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="5" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="6" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="7" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="8" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="9" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="10" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="11" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="12" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="13" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="14" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="15" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="16" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="17" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="18" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="19" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
	</facsimile>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1" xml:id="_gKEvR4t">INTRODUCTION</head><p xml:id="_3ytp83g">Deep learning has achieved impressive success in applications for which the goal is to model a conditional distribution p(y|x), with y being a label and x the features. While the conditional model p(y|x) may be highly accurate on inputs x sampled from the training distribution, there are no guarantees that the model will work well on x's drawn from some other distribution. For example, <ref type="bibr" coords="1,147.37,535.11,107.28,8.64">Louizos &amp; Welling (2017)</ref> show that simply rotating an MNIST digit can make a neural network predict another class with high confidence (see their Figure <ref type="figure" coords="1,390.49,546.07,7.76,8.64" target="#fig_0">1a</ref>). Ostensibly, one way to avoid such overconfidently wrong predictions would be to train a density model p(x; θ) (with θ denoting the parameters) to approximate the true distribution of training inputs p * (x) and refuse to make a prediction for any x that has a sufficiently low density under p(x; θ). The intuition is that the discriminative model p(y|x) likely did not observe enough samples in that region to make a reliable decision for those inputs. This idea has been proposed by various papers, cf. <ref type="bibr" coords="1,414.14,600.87,57.92,8.64" target="#b0">(Bishop, 1994)</ref>, and as recently as in the panel discussion at Advances in Approximate Bayesian Inference (AABI) 2017 <ref type="bibr" coords="1,107.67,622.78,68.21,8.64" target="#b2">(Blei et al., 2017)</ref>.</p><p xml:id="_kHNPfGC">Anomaly detection is just one motivating example for which we require accurate densities, and others include information regularization <ref type="bibr" coords="1,271.47,650.68,113.76,8.64" target="#b26">(Szummer &amp; Jaakkola, 2003)</ref>, open set recognition <ref type="bibr" coords="1,474.03,650.68,29.97,8.64;1,107.61,661.64,77.54,8.64" target="#b10">(Herbei &amp; Wegkamp, 2006)</ref>, uncertainty estimation, detecting covariate shift, active learning, model-based reinforcement learning, and transfer learning. Accordingly, these applications have lead to widespread interest in deep generative models, which take many forms such as variational auto-encoders (VAEs) <ref type="bibr" coords="1,107.67,694.51,106.21,8.64" target="#b12">(Kingma &amp; Welling, 2014;</ref><ref type="bibr" coords="1,216.37,694.51,81.89,8.64" target="#b19">Rezende et al., 2014)</ref>, generative adversarial networks (GANs) <ref type="bibr" coords="1,466.72,694.51,38.93,8.64;2,108.00,85.34,62.09,8.64">(Goodfel-low et al., 2014)</ref>, auto-regressive models <ref type="bibr" coords="2,269.45,85.34,107.85,8.64" target="#b31">(van den Oord et al., 2016b;</ref><ref type="bibr" coords="2,377.30,85.34,8.29,8.64">a)</ref>, and invertible latent variable models <ref type="bibr" coords="2,139.60,96.30,94.21,8.64" target="#b28">(Tabak &amp; Turner, 2013)</ref>. The last two classes-auto-regressive and invertible models-are especially attractive since they offer exact computation of the marginal likelihood, requiring no approximate inference techniques.</p><p xml:id="_rAkCKwM">In this paper, we investigate if modern deep generative models can be used for anomaly detection, as suggested by <ref type="bibr" coords="2,173.19,146.11,57.45,8.64" target="#b0">Bishop (1994)</ref> and the AABI pannel <ref type="bibr" coords="2,320.78,146.11,68.38,8.64" target="#b2">(Blei et al., 2017)</ref>, expecting a well-calibrated model to assign higher density to the training data than to some other data set. However, we find this to not be the case: when trained on <ref type="bibr" coords="2,250.53,168.03,161.09,8.64">CIFAR-10 (Krizhevsky &amp; Hinton, 2009)</ref>, VAEs, autoregressive models, and flow-based generative models all assign a higher density to SVHN <ref type="bibr" coords="2,424.83,178.99,79.83,8.64" target="#b18">(Netzer et al., 2011)</ref> than to the training data. We find this observation to be quite problematic and unintuitive since SVHN's digit images are so visually distinct from the dogs, horses, trucks, boats, etc. found in CIFAR-10. Yet this phenomenon is not restricted to CIFAR-10 vs SVHN, and we report similar findings for models trained on CelebA and ImageNet. We go on to study these curious observations in flow-based models in particular since they allow for exact marginal density calculations. When the flow is restricted to have constant volume across inputs, we show that the out-of-distribution behavior can be explained in terms of the data's variance and the model's curvature.</p><p xml:id="_BsAfexb">To the best of our knowledge, we are the first to report these unintuitive findings for a variety of deep generative models and image data sets. Moreover, our experiments with flow-based models isolate some crucial experimental variables such as the effect of constant-volume vs non-volume-preserving transformations. Lastly, our analysis provides some simple but general expressions for quantifying the gap in the model density between two data sets. We close the paper by urging more study of the out-of-training-distribution properties of deep generative models. Understanding their behaviour in this setting is crucial for their deployment to the real world.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2" xml:id="_R7Gdk7Y">BACKGROUND</head><p xml:id="_HVuUck7">We begin by establishing notation and reviewing the necessary background material. We denote matrices with upper-case and bold letters (e.g. X), vectors with lower-case and bold (e.g. x), and scalars with lower-case and no bolding (e.g. x). As our focus is on generative models, let the collection of all observations be denoted by X = {x n } N n=1 with x representing a vector containing all features and, if present, labels. All N examples are assumed independently and identically drawn from some population x ∼ p * (x) (which is unknown) with support denoted X . We define the model density function to be p(x; θ) where θ ∈ Θ are the model parameters, and let the model likelihood be denoted p(X; θ) = N n=1 p(x n ; θ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1" xml:id="_6SnXAYK">TRAINING NEURAL GENERATIVE MODELS</head><p xml:id="_ud6MBqM">Given (training) data X and a model class {p(•; θ) : θ ∈ Θ}, we are interested in finding the parameters θ that make the model closest to the true but unknown data distribution p * (x). We can quantify this gap in terms of a Kullback-Leibler divergence (KLD):</p><formula xml:id="formula_0" coords="2,149.25,552.59,354.75,23.89">KLD[p * (x)||p(x; θ)] = p * (x) log p * (x) p(x; θ) dx ≈ − 1 N log p(X; θ) − H[p * ]<label>(1)</label></formula><p xml:id="_Jz2MuFh">where the first term in the right-most expression is the average log-likelihood and the second is the entropy of the true distribution. As the latter is a fixed constant, minimizing the KLD amounts to finding the parameter settings that maximize the data's log density: θ * = arg max θ log p(X; θ) = arg max θ N n=1 log p(x n ; θ). Note that p(x n ; θ) alone does not have any interpretation as a probability. To extract probabilities from the model density, we need to integrate over some region Ω: P (Ω) = Ω p(x; θ)dx. Adding noise to the data during model optimization can mock this integration step, encouraging the density model to output something nearer to probabilities <ref type="bibr" coords="2,478.06,652.99,25.94,8.64;2,108.00,663.95,46.02,8.64" target="#b29">(Theis et al., 2016)</ref>:</p><formula xml:id="formula_1" coords="2,161.50,683.98,290.65,12.28">log p(x n + δ; θ)p(δ) dδ ≥ E δ [log p(x n + δ; θ)] ≈ log p(x n + δ; θ)</formula><p xml:id="_7GzQGhs">where δ is a sample from p(δ). The resulting objective is a lower-bound, making it a suitable optimization target. All models in all of the experiments that we report are trained with input noise.</p><p xml:id="_rSssNAN">Due to this ambiguity between densities and probabilities, we call the quantity log p(X + ∆; θ) a 'log-likelihood,' even if X is drawn from a distribution unlike the training data.</p><p xml:id="_RvvMTtG">Regarding the choice of density model, we could choose one of the standard density functions for p(x n ; θ), e.g. a Gaussian, but these may not be suitable for modeling the complex, high-dimensional data sets we often observe in the real world. Hence, we want to parametrize the model density with some high-capacity function f , which is usually chosen to be a neural network. That way the model has a somewhat compact representation and can be optimized via gradient ascent. We experiment with three variants of neural generative models: autoregressive, latent variable, and invertible. In the first class, we study the PixelCNN (van den <ref type="bibr" coords="3,279.36,178.99,71.92,8.64" target="#b31">Oord et al., 2016b)</ref>, and due to space constraints, we refer the reader to <ref type="bibr" coords="3,159.17,189.95,107.55,8.64" target="#b31">van den Oord et al. (2016b)</ref> for its definition. As a representative of the second class, we use a VAE <ref type="bibr" coords="3,150.72,200.91,106.13,8.64" target="#b12">(Kingma &amp; Welling, 2014;</ref><ref type="bibr" coords="3,259.34,200.91,81.85,8.64" target="#b19">Rezende et al., 2014)</ref>. See <ref type="bibr" coords="3,365.26,200.91,74.59,8.64" target="#b21">Rosca et al. (2018)</ref> for descriptions of the precise versions we use. Lastly, invertible flow-based generative models are the third class. We define them in detail below since we study them with the most depth.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2" xml:id="_7Y38TGC">GENERATIVE MODELS VIA CHANGE OF VARIABLES</head><p xml:id="_AJWGfDj">The VAE and many other generative models are defined as a joint distribution between the observed and latent variables. However, another path forward is to perform a change of variables. In this case x and z are one and the same, and there is no longer any notion of a product space X × Z. Let f : X → Z be a diffeomorphism from the data space X to a latent space Z. Using f then allows us to compute integrals over z as an integral over x and vice versa:</p><formula xml:id="formula_2" coords="3,139.87,325.89,364.13,25.55">z p z (z) dz = x p z (f (x)) ∂f ∂x dx = x p x (x) dx = z p x (f −1 (z)) ∂f −1 ∂z dz<label>(2)</label></formula><p xml:id="_6MWrxTN">where |∂f /∂x| and |∂f −1 /∂z| are known as the volume elements as they adjust for the volume change under the alternate measure. Specifically, when the change is w.r.t. coordinates, the volume element is the determinant of the diffeomorphism's Jacobian matrix, which we denote as |∂f /∂x|.</p><p xml:id="_gzwpd7E">The change of variables formula is a powerful tool for generative modeling as it allows us to define a distribution p(x) entirely in terms of an auxiliary distribution p(z), which we are free to choose, and f . Denote the parameters of the change of variables model as θ = {φ, ψ} with φ being the diffeomorphism's parameters, i.e. f (x; φ), and ψ being the auxiliary distribution's parameters, i.e. p(z; ψ). We can perform maximum likelihood estimation for the model as follows:</p><formula xml:id="formula_3" coords="3,144.63,456.23,359.38,30.20">θ * = arg max θ log p x (X; θ) = arg max φ,ψ N n=1 log p z (f (x n ; φ); ψ) + log ∂f φ ∂x n .<label>(3)</label></formula><p xml:id="_gm5YkGk">Optimizing ψ must be done carefully so as to not result in a trivial model. For instance, optimization could make p(z; ψ) close to uniform if there are no constraints on its variance. For this reason, most implementations leave ψ as fixed (usually a standard Gaussian) in practice. Likewise, we assume it as fixed from here forward, thus omitting ψ from equations to reduce notational clutter. After training, samples can be drawn from the model via the inverse transform:</p><formula xml:id="formula_4" coords="3,367.71,534.19,112.36,10.31">x = f −1 ( z; φ), z ∼ p(z).</formula><p xml:id="_hJtFyTw">For the particular form of f , most work to date has constructed the bijection from affine coupling layers (ACLs) <ref type="bibr" coords="3,168.00,563.97,72.39,8.64" target="#b5">(Dinh et al., 2017)</ref>, which transform x by way of translation and scaling operations. Specifically, ACLs take the form:</p><formula xml:id="formula_5" coords="3,247.47,574.58,229.09,9.68">f ACL (x; φ) = [exp{s(x d: ; φ s )} x :d + t(x d: ; φ t ), x d: ] ,</formula><p xml:id="_4VfF45R">where denotes an element-wise product. This transformation, firstly, splits the input vector in half, i.e. x = [x :d , x d: ] (using Python list syntax). Then the second half of the vector is fed into two arbitrary neural networks (possibly with tied parameters) whose outputs are denoted t(x d: ; φ t ) and s(x d: ; φ s ), with φ • being the collection of weights and biases. Finally, the output is formed by (1) scaling the first half of the input by one neural network output, i.e. exp{s(x d: ; φ s )} x :d , (2) translating the result of the scaling operation by the second neural network output, i.e. (•) + t(x d: ; φ t ), and (3) copying the second half of x forward, making it the second half of f ACL (x; φ), i.e. f d: = x d: . ACLs are stacked to make rich hierarchical transforms, and the latent representation z is output from this composition, i.e. z n = f (x n ; φ). A permutation operation is required between ACLs to ensure the same elements are not repeatedly used in the copy operations. We use f without subscript to denote the complete transform and overload the use of φ to denote the parameters of all constituent layers. This class of transform is known as non-volume preserving (NVP) <ref type="bibr" coords="3,387.12,712.42,77.02,8.64" target="#b5">(Dinh et al., 2017)</ref> since the volume element does not necessarily evaluate to one and can vary with each input x. Although non-zero, the log determinant of the Jacobian is still tractable: log |∂f φ /∂x| = D j=d s j (x d: ; φ s ). A diffeomorphic transform can also be defined with just translation operations, as was done in earlier work by <ref type="bibr" coords="4,144.76,108.39,72.20,8.64" target="#b4">Dinh et al. (2015)</ref>, and this transformation is volume preserving (VP) since the volume term is one and thus has no influence in the likelihood calculation. We will examine another class of flows we term constant-volume (CV) since the volume, while not preserved, is constant across all x.</p><p xml:id="_aEk9Sgr">Appendix A provides additional details on implementing flow-based generative models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3" xml:id="_pA834Mb">MOTIVATING OBSERVATIONS</head><p xml:id="_6JHk3dt">Given the impressive advances of deep generative models, we sought to test their ability to quantify when an input comes from a different distribution than that of the training set. This calibration w.r.t. out-of-distribution data is essential for applications such as safety-if we were using the generative model to filter the inputs to a discriminative model-and for active learning. For the experiment, we trained the same Glow architecture described in Kingma &amp; Dhariwal (2018)-except small enough that it could fit on one GPU<ref type="foot" coords="4,268.77,248.62,3.49,6.05" target="#foot_0">1</ref> -on FashionMNIST and CIFAR-10. Appendix A provides additional implementation details. We then calculated the log-likelihood (higher value is better) and bits-per-dimension (BPD, lower value is better)<ref type="foot" coords="4,293.28,270.54,3.49,6.05" target="#foot_1">2</ref> of the test split of two different data sets of the same dimensionality-MNIST (28 × 28) and SVHN (32 × 32 × 3) respectively. We expect the models to assign a lower probability to this data because they were not trained on it. Samples from the Glow models trained on each data set are shown in Figure <ref type="figure" coords="4,316.93,305.09,9.96,8.64" target="#fig_19">13</ref>   Beginning with FashionMNIST vs MNIST, the left subtable of Figure <ref type="figure" coords="4,390.73,472.50,5.02,8.64" target="#fig_0">1</ref> shows the average BPD of the training data (FashionMNIST-Train), the in-distribution test data (FashionMNIST-Test), and the out-of-distribution data (MNIST-Test). We see a peculiar result: the MNIST split has the lowest BPD, more than one bit less than the FashionMNIST train and test sets. To check if this is due to outliers skewing the average, we report a (normalized) histogram in Figure <ref type="figure" coords="4,370.99,516.34,4.88,8.64">2</ref> (a) of the log-likelihoods for the three splits. We see that MNIST (red bars) is clearly and systematically shifted to the RHS of the plot (highest likelihood).</p><p xml:id="_7eYSr83">Moving on to CIFAR-10 vs SVHN, the right subtable of Figure <ref type="figure" coords="4,354.71,555.19,4.88,8.64" target="#fig_0">1</ref> again reports the BPD of the training data (CIFAR10-Train), the in-distribution test data (CIFAR10-Test), and the out-of-distribution data (SVHN-Test). We again see the phenomenon: the SVHN BPD is one bit lower than that of both in-distribution data sets. Subfigures (c) and (d) of Figure <ref type="figure" coords="4,237.81,626.92,5.02,8.64">2</ref> show additional results for CelebA and ImageNet. When trained on CelebA, Glow assigns a higher likelihood to SVHN (red bars), a data set the model has never seen before. Similarly, when trained on ImageNet, Glow assigns a higher likelihood to the test splits of SVHN (red), CIFAR-10 (yellow), and CIFAR-100 (green). The difference is quite drastic in the case of SVHN (red) but modest for the two CIFAR splits. This phenomenon is not symmetric. CIFAR-10 does not have a higher likelihood under a Glow trained on SVHN; see Figure <ref type="figure" coords="4,434.32,681.72,5.08,8.64">6</ref> in Appendix B for these results. We report results only for Glow, but we observed the same behavior for RNVP transforms <ref type="bibr" coords="5,153.10,409.97,71.53,8.64" target="#b5">(Dinh et al., 2017)</ref>.</p><p xml:id="_Tk6zQww">We next tested if the phenomenon occurs for other common deep generative models: PixelCNNs and VAEs. We do not include GANs in the comparison since evaluating their likelihood is an open problem. Figure <ref type="figure" coords="5,174.03,448.82,4.88,8.64">3</ref> reports the same histograms as above for these models, showing the distribution of log p(x) evaluations for FashionMNIST vs MNIST (a, b) and CIFAR-10 vs SVHN (c, d). The training splits are again denoted with black bars, and the test splits with blue, and the out-of-distribution splits with red. The red bars are shifted to the right in all four plots, signifying the behavior exists in spite of the differences between model classes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4" xml:id="_kgseN3x">DIGGING DEEPER INTO THE FLOW-BASED MODEL</head><p xml:id="_S7Hnarf">While we observed the out-of-distribution phenomenon for PixelCNN, VAE, and Glow, now we narrow our investigation to just the class of invertible generative models. The rationale is that they allow for better experimental control as, firstly, they can compute exact marginal likelihoods (unlike VAEs), and secondly, the transforms used in flow-based models have Jacobian constraints that simplify the analysis we present in Section 5. To further analyze the high likelihood of the out-of-distribution (non-training) samples, we next report the contributions to the likelihood of each term in the change-of-variables formula. At first this suggested the volume element was the primary cause of SVHN's high likelihood, but further experiments with constant-volume flows show the problem exists with them as well.</p><p xml:id="_FzdHpGS">Decomposing the change-of-variables objective. To further examine this curious phenomenon, we inspect the change-of-variables objective itself, investigating if one or both terms give the outof-distribution data a higher value. We report the constituent log p(z) and log |∂f φ /∂x| terms for NVP-Glow in Figure <ref type="figure" coords="5,196.52,690.50,3.81,8.64" target="#fig_5">4</ref>, showing histograms for log p(z) in subfigure (a) and for log |∂f φ /∂x| in subfigure (b). We see that p(z) behaves mostly as expected. The red bars (SVHN) are clearly shifted to the left, representing lower likelihoods under the latent distribution. Moving on to the volume element, this term seems to cause SVHN's higher likelihood. Subfigure (b) shows that all of the   SVHN log-volume evaluations (red) are conspicuously shifted to the right-to higher values-when compared to CIFAR-10's (blue and black). Since SVHN's p(z) evaluations are only slightly less than CIFAR-10's, the volume term dominates, resulting in SVHN having a higher likelihood.</p><p xml:id="_kWuHTYP">Is the volume the culprit? In addition to the empirical evidence against the volume element, we notice that one of the terms in the change-of-variables objective-by rewarding the maximization of the Jacobian determinant-encourages the model to increase its sensitivity to perturbations in X . This behavior starkly contradicts a long history of derivative-based regularization penalties that reward the model for decreasing its sensitivity to input directions. For instance, <ref type="bibr" coords="6,387.06,662.60,77.10,8.64" target="#b6">Girosi et al. (1995)</ref> and <ref type="bibr" coords="6,483.80,662.60,20.20,8.64;6,108.00,673.56,47.48,8.64" target="#b20">Rifai et al. (2011)</ref> propose penalizing the Frobenius norm of a neural network's Jacobian for classifiers and autoencoders respectively. See Appendix C for more analysis of the log volume element.</p><p xml:id="_24JbsgW">To experimentally control for the effect of the volume term, we trained Glow with constant-volume (CV) transformations. We modify the affine layers to use only translation operations <ref type="bibr" coords="6,456.24,712.42,49.00,8.64;6,108.00,723.38,22.78,8.64" target="#b4">(Dinh et al., 2015)</ref> but keep the 1 × 1 convolutions as is. The log-determinant-Jacobian is then</p><formula xml:id="formula_6" coords="6,431.24,723.06,74.00,11.15">HW k log |U k |,</formula><p xml:id="_KJ8Guxw">where |U k | is the determinant of the convolutional weights U k for the kth flow. This makes the volume element constant across all inputs x, allowing us to isolate its effect while still keeping the model expressive. Subfigures (c) and (d) of Figure <ref type="figure" coords="7,310.68,107.26,4.96,8.64" target="#fig_5">4</ref> show the results for this model, which we term CV-Glow (constant-volume Glow). Subfigure (c) shows a histogram of the log p(x) evaluations, just as shown before in Figure <ref type="figure" coords="7,215.95,129.17,3.81,8.64">2</ref>, and we see that SVHN (red) still achieves a higher likelihood (lower BPD) than the CIFAR-10 training set. Subfigure (d) shows the SVHN vs CIFAR-10 BPD over the course of training for NVP-Glow. Notice that there is no cross-over point in the curves.</p><p xml:id="_fAbxuf3">Other experiments: random and constant images, ensembles. Other work on generative models <ref type="bibr" coords="7,107.67,185.44,87.65,8.64" target="#b24">(Sønderby et al., 2017;</ref><ref type="bibr" coords="7,197.24,185.44,99.36,8.64" target="#b32">van den Oord et al., 2018)</ref> has noted that they often assign the highest likelihood to constant inputs. We also test this case, reporting the BPD in Appendix Figure <ref type="figure" coords="7,436.27,196.40,5.08,8.64">8</ref> for NVP-Glow models. We find constant inputs have the highest likelihood for our models as well: 0.589 BPD for CIFAR-10. We also include in the table the BPD of random inputs for comparison.</p><p xml:id="_KfH5GRe">We also hypothesized that averaging over the parameters may mitigate the phenomenon. While integration over the entire parameter space would be ideal, this is analytically and computationally difficult for Glow. <ref type="bibr" coords="7,187.22,257.17,130.99,8.64" target="#b15">Lakshminarayanan et al. (2017)</ref> show that deep ensembles can guard against over-confidence for anomalous inputs while being more practical to implement. We opted for this approach, training five Glow models independently and averaging their likelihoods to evaluate test data. Each model was given a different initialization of the parameters to help diversify the ensemble. Figure <ref type="figure" coords="7,137.53,301.01,5.08,8.64" target="#fig_12">9</ref> in Appendix F reports a histogram of the log p(x) evaluations when averaging over the ensemble. We see nearly identical results: SVHN is still assigned a higher likelihood than the CIFAR-10 training data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5" xml:id="_vBPQuMr">SECOND ORDER ANALYSIS</head><p xml:id="_EaB7BwK">In this section, we aim to provide a more direct analysis of when another distribution might have higher likelihood than the one used for training. We propose analyzing the phenomenon by way of linearizing the difference in expected log-likelihoods. This approach undoubtedly gives a crude approximation, but as we show below, it agrees with and gives insight into some of the observations reported above. Consider two distributions: the training distribution x ∼ p * and some dissimilar distribution x ∼ q also with support on X . For a given generative model p(x; θ), the adversarial distribution q will have a higher likelihood than the training data's if E q [log p(x; θ)] − E p * [log p(x; θ)] &gt; 0. This expression is hard to analyze directly so we perform a second-order expansion of the log-likelihood around an interior point x 0 . Applying the expansion log p(x; θ) ≈ log p(x 0 ; θ)+∇ x0 log p(x 0 ; θ) T (x−x 0 )+ 1 2 Tr{∇ 2 x0 log p(x 0 ; θ)(x − x 0 )(x − x 0 ) T } to both likelihoods, taking expectations, and canceling the common terms, we have:</p><formula xml:id="formula_7" coords="7,145.17,499.75,358.83,36.03">0 &lt; E q [log p(x; θ)] − E p * [log p(x; θ)] ≈ ∇ x0 log p(x 0 ; θ) T (E q [x] − E p * [x]) + 1 2 Tr{∇ 2 x0 log p(x 0 ; θ)(Σ q − Σ p * )}<label>(4)</label></formula><p xml:id="_SDBU4pp">where Σ = E (x − x 0 )(x − x 0 ) T , the covariance matrix, and Tr{•} is the trace operation. Since the expansion is accurate only locally around x 0 , we next assume that</p><formula xml:id="formula_8" coords="7,386.14,553.91,90.72,9.68">E q [x] = E p * [x] = x 0 .</formula><p xml:id="_8eJ3J9x">While this at first glance may seem like a strong assumption, it is not too removed from practice since data is usually centered before being fed to the model. For SVHN and CIFAR-10 in particular, we find this assumption to hold; see Figure <ref type="figure" coords="7,252.73,587.14,5.08,8.64" target="#fig_8">5</ref> (a) for the empirical means of each dimension of CIFAR-10 (green) and SVHN (orange). All of SVHN's means fall within the empirical range of CIFAR-10's, and the maximum difference between any dimension is less than 38 pixel values. Assuming equal means, we then have:</p><formula xml:id="formula_9" coords="7,147.64,634.02,356.36,48.49">0 &lt; E q [log p(x; θ)] − E p * [log p(x; θ)] ≈ 1 2 Tr{∇ 2 x0 log p(x 0 ; θ)(Σ q − Σ p * )} = 1 2 Tr ∇ 2 x0 log p z (f (x 0 ; φ)) + ∇ 2 x0 log ∂f φ ∂x 0 (Σ q − Σ p * ) ,<label>(5)</label></formula><p xml:id="_T3FTUrz">where the second line assumes the generative model to be flow-based.</p><p xml:id="_MnrbrMG">Analysis of CV-Glow. We use the expression in Equation <ref type="formula" coords="7,344.37,712.42,4.88,8.64" target="#formula_9">5</ref>to analyze the behavior of CV-Glow on CIFAR-10 vs SVHN, seeing if the difference in likelihoods can be explained by the model curvature and data's second moment. The second derivative terms simplify considerably for CV-Glow with a spherical latent density. Given a C × C kernel U k , with k indexing the flow and C the number of input channels, the derivatives are ∂f h,w,c /∂x h,w,c = k C j=1 u k,c,j , with h and w indexing the spatial height and width and j the columns of the kth flow's 1 × 1 convolutional kernel. The second derivative is then ∂ 2 f h,w,c /∂x 2 h,w,c = 0, which allows us to write</p><formula xml:id="formula_10" coords="8,161.58,150.03,288.84,52.14">Tr ∇ 2 x0 log p(x 0 ; θ) (Σ q − Σ p * ) = ∂ 2 ∂z 2 log p(z; ψ) C c=1   K k=1 C j=1 u k,c,j   2 h,w (σ 2 q,h,w,c − σ 2 p * ,h,w,c ).</formula><p xml:id="_4zuX5Df">The derivation is given in Appendix G. Plugging in the second derivative of the Gaussian's log density-a common choice for the latent distribution in flow models <ref type="bibr" coords="8,385.83,222.70,73.61,8.64" target="#b5">(Dinh et al., 2017;</ref><ref type="bibr" coords="8,461.92,222.70,42.86,8.64;8,108.00,233.65,68.39,8.64" target="#b11">Kingma &amp; Dhariwal, 2018)</ref>-and the empirical variances, we have:</p><formula xml:id="formula_11" coords="8,141.35,250.33,362.65,74.00">E SVHN [log p(x; θ)] − E CIFAR-10 [log p(x; θ)] ≈ −1 2σ 2 ψ α 2 1 (49.6 − 61.9) + α 2 2 (52.7 − 59.2) + α 2 3 (53.6 − 68.1) = 1 2σ 2 ψ α 2 1 • 12.3 + α 2 2 • 6.5 + α 2 3 • 14.5 ≥ 0 where α c = K k=1 C j=1 u k,c,j<label>(6)</label></formula><p xml:id="_DYpTHqg">and where σ 2 ψ is the variance of the latent distribution. We know the final expression is greater than or equal to zero since all α 2 c ≥ 0. Equality is achieved only for σ 2 ψ → ∞ or in the unusual case of at least one all-zero row in any convolutional kernel for all channels. Thus, the second-order expression does indeed predict we should see a higher likelihood for SVHN than for CIFAR-10. Moreover, we leave the CV-Glow's parameters as constants to emphasize the expression is non-negative for any parameter setting. This finding is supported by our observations that using an ensemble of Glows resulted in an almost identical likelihood gap (Figure <ref type="figure" coords="8,318.01,401.99,4.07,8.64" target="#fig_12">9</ref>) and that the gap remained relatively constant over the course of training (Figure <ref type="figure" coords="8,245.02,412.95,7.75,8.64" target="#fig_5">4d</ref>). Furthermore, the ∂ 2 log p(z; ψ)/∂z 2 term would be negative for any log-concave density function, meaning that changing the latent density to Laplace or logistic would not change the result.   Our conclusion is that SVHN simply "sits inside of" CIFAR-10-roughly same mean, smaller variance-resulting in its higher likelihood. This insight also holds true for the additional results presented in subfigures (c) and (d) of Figure <ref type="figure" coords="8,285.16,646.66,3.71,8.64">2</ref>. Examining Figure <ref type="figure" coords="8,369.96,646.66,4.95,8.64" target="#fig_8">5</ref> (a) again, we see that ImageNet, the CIFARs, and SVHN all have nearly overlapping means and that ImageNet has the highest variance. Therefore we expect SVHN and the CIFARs to have a higher likelihood than ImageNet on an ImageNet-trained model, which is exactly what we observe in Figure <ref type="figure" coords="8,420.16,679.54,18.74,8.64">2 (d)</ref>. Moreover, the degree of the differences in likelihoods agrees with the differences in variances. SVHN clearly has the smallest variance and the largest likelihood. In turn, we can artificially increase the likelihood of a data set by shrinking its variance. For RGB images, shrinking the variance is equivalent to 'graying' the images, i.e. making the pixel values closer to 128. We show in Figure <ref type="figure" coords="8,442.05,723.38,5.01,8.64" target="#fig_8">5</ref> (b) that doing exactly this improves the likelihood of both CIFAR-10 and SVHN. Reducing the variance of the latent representations has the same effect, which is shown by Figure <ref type="figure" coords="9,381.42,96.30,9.96,8.64" target="#fig_18">12</ref> in the Appendix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6" xml:id="_nSkDCkD">RELATED WORK</head><p xml:id="_pJdRwCY">This paper is inspired by and most related to recent work on evaluation of generative models. Worthy of foremost mention is the work of <ref type="bibr" coords="9,249.34,160.08,71.40,8.64" target="#b29">Theis et al. (2016)</ref>, which showed that high likelihood is neither sufficient nor necessary for the model to produce visually satisfying samples. However, their paper does not consider out-of-distribution inputs. In this regard, there has been much work on adversarial inputs <ref type="bibr" coords="9,136.03,192.96,88.83,8.64" target="#b25">(Szegedy et al., 2014)</ref>. While the term is used broadly, it commonly refers to inputs that have been imperceptibly modified so that the model can no longer provide an accurate output (a mis-classification, usually). Adversarial attacks on generative models have been studied by (at least) <ref type="bibr" coords="9,107.69,225.83,83.21,8.64" target="#b27">Tabacof et al. (2016)</ref> and <ref type="bibr" coords="9,210.34,225.83,65.30,8.64" target="#b13">Kos et al. (2018)</ref>, but these methods of attack require access to the model. We, on the other hand, are interested in model calibration for any out-of-distribution set and especially for common data sets not constructed with any nefarious intentions nor for attack on a particular model. Various papers <ref type="bibr" coords="9,202.79,258.71,119.68,8.64" target="#b8">(Hendrycks &amp; Gimpel, 2017;</ref><ref type="bibr" coords="9,325.19,258.71,128.40,8.64" target="#b15">Lakshminarayanan et al., 2017;</ref><ref type="bibr" coords="9,456.33,258.71,48.92,8.64;9,108.00,269.67,23.64,8.64" target="#b17">Liang et al., 2018)</ref> have reported that discriminative neural networks can produce overconfident predictions on out-of-distribution inputs. In a related finding, <ref type="bibr" coords="9,295.33,280.63,66.17,8.64" target="#b16">Lee et al. (2018)</ref> reported that it was much harder to recognize an input as out-of-distribution when the classifier was trained on CIFAR-10 in comparison to training on SVHN.</p><p xml:id="_dzPbdfx">Testing the robustness of deep generative models to out-of-distribution inputs had not been investigated previously, to the best of our knowledge. However, there is work concurrent with ours that has tested their ability to detect anomalous inputs. <ref type="bibr" coords="9,279.17,341.40,84.94,8.64" target="#b22">Shafaei et al. (2018)</ref> and <ref type="bibr" coords="9,385.62,341.40,98.59,8.64" target="#b9">Hendrycks et al. (2019)</ref> also observe that PixelCNN++ cannot provide reliable outlier detection. <ref type="bibr" coords="9,376.07,352.36,93.18,8.64" target="#b9">Hendrycks et al. (2019)</ref> mitigate the CIFAR-10 vs SVHN issue by exposing the model to outliers during training. They do not consider flow-based models. <ref type="bibr" coords="9,224.86,375.42,78.76,8.64">Škvára et al. (2018)</ref> experimentally compare VAEs and GANs against k-nearest neighbors (kNNs), showing that VAEs and GANs outperform kNNs only when known outliers can be used for hyperparameter selection. In the work most similar to ours, <ref type="bibr" coords="9,452.21,397.34,51.78,8.64;9,107.67,408.30,26.56,8.64" target="#b3">Choi &amp; Jang (2018)</ref> report the same CIFAR-10 vs SVHN phenomenon for Glow-independently confirming our motivating observation. As a fix, they propose training an ensemble of generative models with an adversarial objective and testing for out-of-training-distribution inputs by computing the Watanabe-Akaike information criterion via the ensemble. This work is complementary to ours since they focus on providing a detection method whereas we are interested in understanding how and when the phenomenon can arise. The results we present in Equation <ref type="formula" coords="9,346.07,463.09,5.05,8.64" target="#formula_11">6</ref>do not apply to <ref type="bibr" coords="9,416.88,463.09,78.71,8.64" target="#b3">Choi &amp; Jang (2018)</ref>'s models since they use scaling operations in their affine coupling layers, making them NVP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7" xml:id="_ZEYB6kc">DISCUSSION</head><p xml:id="_Y8NkAFB">We have shown that comparing the likelihoods of deep generative models alone cannot identify the training set or inputs like it. Therefore we urge caution when using these models with outof-training-distribution inputs or in unprotected user-facing systems. Moreover, our analysis in Section 5 shows that the CIFAR-10 vs SVHN phenomenon would persist for any constant-volume Glow no matter the parameter values nor the choice of latent density (as long as it is log-concave). While we cannot conclude that this is a pathology in deep generative models, it does suggest the need for further work on generative models and their evaluation. The models we tested seem to be capturing low-level statistics rather than high-level semantics, and better inductive biases, optimization procedures, or uncertainty quantification may be necessary. Yet, deep generative models can detect out-of-distribution inputs when using alternative metrics <ref type="bibr" coords="9,370.81,625.51,79.81,8.64" target="#b3">(Choi &amp; Jang, 2018)</ref> and modified training procedures <ref type="bibr" coords="9,187.81,636.46,94.90,8.64" target="#b9">(Hendrycks et al., 2019)</ref>. The problem then may be a fundamental limitation of high-dimensional likelihoods. Until these open problems are better understood, we must temper the enthusiasm with which we preach the benefits of deep generative models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_JkTxa4z">A ADDITIONAL IMPLEMENTATION DETAILS A.1 FLOW-BASED MODELS</head><p xml:id="_xwjsCTV">We have described the core building blocks of invertible generative models above, but there are several other architectural choices required in practice. Due to space requirements, we only describe them briefly, referring the reader to the original papers for details. In the most recent extension of this line of work, <ref type="bibr" coords="12,144.42,167.18,111.77,8.64" target="#b11">Kingma &amp; Dhariwal (2018)</ref> propose the Glow architecture, with its foremost contribution being the use of 1 × 1 convolutions in place of discrete permutation operations. Convolutions of this form can be thought of as a relaxed but generalized permutation, having all the representational power of the discrete version with the added benefit of parameters amenable to gradient-based training. As the transformation function becomes deeper, it becomes prone to the same scale pathologies as deep neural networks and therefore requires a normalization step of some form. <ref type="bibr" coords="12,432.79,221.98,71.88,8.64" target="#b5">Dinh et al. (2017)</ref> propose incorporating batch normalization and describe how to compute its contribution to the log-determinant-Jacobian term. Kingma &amp; Dhariwal (2018) apply a similar normalization, which they call actnorm, but it uses trainable parameters instead of batch statistics. Lastly, both <ref type="bibr" coords="12,463.94,254.86,41.80,8.64;12,107.67,265.81,27.09,8.64" target="#b5">Dinh et al. (2017)</ref> and Kingma &amp; Dhariwal (2018) use multi-scale architectures that factor out variables at regular intervals, copying them forward to the final latent representation. This gradually reduces the dimensionality of the transformations, improving upon computational costs.</p><p xml:id="_UgMa2Yq">For our MNIST experiments, we used a Glow architecture of 2 blocks of 16 affine coupling layers, squeezing the spatial dimension in between the 2 blocks. For our CIFAR experiments, we used 3 blocks of 8 affine coupling blocks, applying the multi-scale architecture between each block. For all coupling blocks, we used a 3-layer Highway network with 200 hidden units for MNIST and 400 hidden units for CIFAR. The networks we trained were shallower than those in <ref type="bibr" coords="12,422.71,348.50,81.29,8.64;12,107.67,359.46,25.15,8.64" target="#b11">Kingma &amp; Dhariwal (2018)</ref>. We also found that initializing the last layer of the coupling networks to 0 was sufficient to prevent scale pathologies, hence we did not use any form of normalization (batchnorm nor actnorm) for ease of initialization and training in a distributed setting. Convolution kernels were initialized with a truncated normal with variance 1/ √ D where D is fan-in size, except where zero-initialization is prescribed by Glow. All networks were trained with the RMSProp optimizer, with a learning rate of 1e − 5 for 100K steps, decaying by half at 80K and 90K steps. We used a prior with zero mean and unit variance for all experiments. We applied L2 regularization of 5e − 2 to CIFAR experiments. All experiments used batch size 32.</p><p xml:id="_YyWyA7k">For CV-Glow, we used additive rather than affine coupling blocks, which removes the influence of coupling blocks on the log-det-Jacobian term. The volume change of the 1 × 1 convolutions depend on its weights rather than the input, so the network has a constant volume change.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_fbDgQY8">A.2 PIXELCNN</head><p xml:id="_SEbSzHz">We trained a GatedPixelCNN with a categorical distribution. For FashionMNIST, we used a network with 5 gated layers with 32 features, and the final skip connection layer with size 256. We trained for 100K steps with the Adam optimizer and an initial learning rate of 1e − 4, and decaying at 80K and 90K steps. For CIFAR experiments, we used 15 dated layers with 128 features, and a skip connection size of 1024. Convolutions were initialized with Tensorflow's variance scaling initializer with a uniform distribution and a scale of 1. We trained for 200K steps with the RMSProp optimizer with an initial learning rate of 1e − 4, decaying by 1/3 at 120K, 180K, and 195K steps. All experiments used batch size 32.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_BjC8jt8">A.3 VARIATIONAL AUTO-ENCODERS</head><p xml:id="_XDUPGuG">We refer to <ref type="bibr" coords="12,154.83,657.62,132.50,8.64">(Rosca et al., 2018, Appendix K)</ref> for additional details on the VAEs used in our CIFAR experiments. We used the CIFAR configurations without modification. For FashionMNIST, we used the encoder given in Table <ref type="table" coords="12,213.56,679.54,4.88,8.64">4</ref> of <ref type="bibr" coords="12,231.55,679.54,158.92,8.64">(Rosca et al., 2018, Appendix K, Table 4</ref>) and a decoder composed of one linear layer with 7 * 7 * 64 hidden units, followed by a reshape and three transposed convolutions of feature sizes 32, 32, 256 and strides 2, 2, 1. Weights were initialized with a normal distribution with variance 0.02. We trained for 200K steps using the RMSProp optimizer, with a constant learning rate of 1e − 4. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_Evcxsye">B RESULTS ILLUSTRATING ASYMMETRIC BEHAVIOR</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_DQr75zS">C ANALYZING THE CHANGE-OF-VARIABLES FORMULA AS AN OPTIMIZATION FUNCTION</head><p xml:id="_T97FvSb">Consider the intuition underlying the volume term in the change of variables objective (Equation <ref type="formula" coords="13,494.98,343.56,3.59,8.64" target="#formula_3">3</ref>).</p><p xml:id="_CV7nTkY">As we are maximizing the Jacobian's determinant, it means that the model is being encouraged to maximize the ∂f j /∂x j partial derivatives. In other words, the model is rewarded for making the transformation sensitive to small changes in x. This behavior starkly contradicts a long history of derivative-based regularization penalties. Dating back at least to <ref type="bibr" coords="13,374.98,387.40,79.24,8.64" target="#b6">(Girosi et al., 1995)</ref>, penalizing the Frobenius norm of a neural network's Jacobian-which upper bounds the volume term<ref type="foot" coords="13,476.31,396.69,3.49,6.05" target="#foot_3">3</ref> -has been shown to improve generalization. This agrees with intuition since we would like the model to be insensitive to small changes in the input, which are likely noise. <ref type="bibr" coords="13,400.64,420.27,104.03,8.64">Moreover, Bishop (1995)</ref> showed that training a network under additive Gaussian noise is equivalent to Jacobian regularization, and <ref type="bibr" coords="13,124.85,442.19,70.61,8.64" target="#b20">Rifai et al. (2011)</ref> proposed contractive autoencoders, which penalize the Jacobian-norm of the encoder. Allowing invertible generative models to maximize the Jacobian term without constraint suggests, at minimum, that these models will not learn robust representations.</p><p xml:id="_7Zru9dc">Limiting Behavior. We next attempt to quantify the limiting behavior of the log volume element. Let us assume, for the purposes of a general treatment, that the bijection f φ is an L-Lipschitz function.</p><p xml:id="_YQ4kTKj">Both terms in Equation 3 can be bounded as follows:</p><formula xml:id="formula_12" coords="13,162.66,524.25,341.34,38.42">log p(x; θ) = log p z (f (x; φ)) O(maxz log pz(z) + log ∂f φ ∂x O(D log L) ≤ max z log p z (z) + D log L (7)</formula><p xml:id="_AYwYWKx">where L is the Lipschitz constant, D the dimensionality, and O(max z log p z (z)) an expression for the (log) mode of p(z). We will make this mode term for concrete for Gaussian distributions below. The bound on the volume term follows from Hadamard's inequality:</p><formula xml:id="formula_13" coords="13,191.51,607.55,228.97,30.32">log ∂f φ ∂x ≤ log D j=1 ∂f φ ∂x e j ≤ log(L |e • |) D = D log L</formula><p xml:id="_snmBdRj">where e j is an eigenvector. While this expression is too general to admit any strong conclusions, we can see from it that the 'peakedness' of the distribution represented by the mode must keep pace with the Lipschitz constant, especially as dimensionality increases, in order for both terms to contribute equally to the objective.</p><p xml:id="_QGmHnPA">We can further illuminate the connection between L and the concentration of the latent distribution through the following proposition:</p><p xml:id="_mCeUv4w">Published as a conference paper at ICLR 2019 Proposition 1. Assume x ∼ p * is distributed with moments E[x] = µ x and V ar[x] = σ 2 x . Moreover, let f : X → Z be L-Lipschitz and f (µ x ) = µ z . We then have the following concentration inequality for some constant δ:</p><formula xml:id="formula_14" coords="14,107.69,118.72,396.30,59.39">P (|f (x) − µ z | ≥ δ) ≤ L 2 σ 2 x δ 2 . Proof : From the fact that f is L-Lipschitz, we know |f (x) − µ z | ≤ L x − f −1 (µ z ) . Assuming µ x = f −1 (µ z ))</formula><p xml:id="_9QHJbqG">, we can apply Chebyshev's inequality to the RHS:</p><formula xml:id="formula_15" coords="14,108.00,166.88,396.00,25.14">P r(L x − f −1 (µ z ) ≥ δ) ≤ L 2 σ 2 x /δ 2 . Since L x − f −1 (µ z ) ≥ |f (x) − µ z |,</formula><p xml:id="_Wy37jNU">we can plug the RHS into the inequality and the bound will continue to hold.</p><p xml:id="_wBs6RYs">From the inequality we can see that the latent distribution can be made more concentrated by decreasing L and/or the data's variance σ 2</p><p xml:id="_yhHRmDT">x . Since the latter is fixed, optimization only influences L. Yet, recall that the volume term in the change-of-variables objective rewards increasing f 's derivatives and thus L. While we have given an upper bound and therefore cannot say that increasing L will necessarily decrease concentration in latent space, it is for certain that leaving L unconstrained does not directly pressure the f (x) evaluations to concentrate.</p><p xml:id="_Kavaq2B">Previous work <ref type="bibr" coords="14,169.89,281.35,75.30,8.64" target="#b4">(Dinh et al., 2015;</ref><ref type="bibr" coords="14,248.08,281.35,23.15,8.64">2017;</ref><ref type="bibr" coords="14,274.12,281.35,113.29,8.64" target="#b11">Kingma &amp; Dhariwal, 2018)</ref> has almost exclusively used a factorized zero-mean Gaussian as the latent distribution, and therefore we examine this case in particular. The log-mode can be expressed as −D/2 • log 2πσ 2 z , making the likelihood bound log N(f (x; φ); 0, σ 2 z I) + log</p><formula xml:id="formula_16" coords="14,298.83,322.59,201.30,22.31">∂f φ ∂x ≤ −D 2 log 2πσ 2 z + D log L. (<label>8</label></formula><formula xml:id="formula_17" coords="14,500.13,329.65,3.87,8.64">)</formula><p xml:id="_D9y4JGm">We see that both terms scale with D although in different directions, with the contribution of the z-distribution becoming more negative and the volume term's becoming more positive. We performed a simulation to demonstrate this behavior on the two moons data set, which is shown in Figure <ref type="figure" coords="14,484.81,377.29,4.96,8.64" target="#fig_11">7</ref>   </p><formula xml:id="formula_18" coords="15,168.33,117.67,335.67,31.69">log ∂f φ ∂x = F f =1 d f j=1 log sigmoid(s f,j (x d f : ; φ s )) ≤ F D log 1 = 0 (9)</formula><p xml:id="_BWsryge">where f indexes the flows and d f the dimensionality at flow f . Interestingly, this parametrization has a fixed upper bound of zero, removing the dependence on D found in Equation <ref type="formula" coords="15,428.42,173.40,3.78,8.64" target="#formula_16">8</ref>. We demonstrate the change in behavior introduced by the alternate parametrization via the same two moon simulation. The only difference is that the RNVP transforms use a sigmoid parametrizations for the scaling operation. See Figure <ref type="figure" coords="15,203.33,206.28,5.08,8.64" target="#fig_11">7</ref> (c) for the results: we see that now both change-of-variable terms are oriented downward as dimensionality grows. We conjecture this parametrization helps condition the log-likelihood, limiting the volume term's influence, when training the large models (∼ 90 flows) used by <ref type="bibr" coords="15,140.81,239.16,107.71,8.64" target="#b11">Kingma &amp; Dhariwal (2018)</ref>. However, it does not fix the out-of-distribution over-confidence we report in Section 3. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_UnpbtKM">E CONSTANT AND RANDOM INPUTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_P4hQQAt">F ENSEMBLING GLOWS</head><p xml:id="_ZnZxD6p">The likelihood function technically measures how likely the parameters are under the data (and not how likely the data is under the model), and perhaps a better quantity would be the posterior predictive distribution p(x test |x train ) = 1 M m p(x test |θ m ) where we draw samples from posterior distribution θ m ∼ p(θ|x train ). Intutitively, it seems that such an integration would be more robust than a single maximum likelihood point estimate. As a crude approximation to Bayesian inference, we tried averaging over ensembles of generative models since <ref type="bibr" coords="15,371.92,527.98,132.74,8.64" target="#b15">Lakshminarayanan et al. (2017)</ref> showed that ensembles of discriminative models are robust to out-of-distribution inputs. We compute an "ensemble predictive distribution" as p(x) = 1 M m p(x; θ m ), where m indexes over models. However, as Figure <ref type="figure" coords="15,187.71,560.86,4.98,8.64" target="#fig_12">9</ref> shows, ensembles did not significantly change the relative difference between in-distribution (CIFAR-10, black and blue) and out-of-distribution (SVHN, red).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_zpSpdTJ">G DERIVATION OF CV-GLOW'S LIKELIHOOD DIFFERENCE</head><p xml:id="_zZbgQzF">We start with Equation <ref type="formula" coords="15,201.37,631.00,3.88,8.64" target="#formula_9">5</ref>:</p><formula xml:id="formula_19" coords="15,175.90,652.19,261.39,23.23">1 2 Tr ∇ 2 x0 log p z (f (x 0 ; φ)) + ∇ 2 x0 log ∂f φ ∂x 0 (Σ q − Σ p * ) .</formula><p xml:id="_XsXEdhX">The volume element for CV-Glow does not depend on x 0 and therefore drops from the equation: where U k denotes the kth 1 × 1-convolution's kernel. Moving on to the first term, the log probability under the latent distribution, we have:</p><formula xml:id="formula_20" coords="15,215.73,708.32,275.82,26.88">∇ 2 x0 log ∂f φ ∂x 0 = ∇ 2 x0 HW k log |U k | = 0<label>(</label></formula><formula xml:id="formula_21" coords="16,124.87,344.20,379.13,95.15">∇ 2 x0 log p(f (x 0 ); ψ) = ∇ 2 x0 −1 2σ 2 ψ ||f (x 0 )|| 2 2 − D 2 log 2πσ 2 ψ = ∇ x0 −1 σ 2 ψ d f d (x 0 ) ∇ x0 f (x 0 ) = −1 σ 2 ψ ∇ x0 f (x 0 )(∇ x0 f (x 0 )) T + d f d (x 0 ) ∇ 2 x0 f (x 0 ) .<label>(11)</label></formula><p xml:id="_qdPY6PM">Since f is comprised of translation operations and 1 × 1 convolutions, its partial derivatives involve just the latter (as the former are all ones), and therefore we have the partial derivatives: </p><formula xml:id="formula_22" coords="16,117.04,605.25,386.96,128.46">1 2 Tr ∇ 2 x0 log p(f (x 0 )) + ∇ 2 x0 log ∂f ∂x 0 (Σ q − Σ p * ) = 1 2 Tr ∇ 2 x0 log p(f (x 0 )) (Σ q − Σ p * ) = −1 2σ 2 ψ Tr ∇ x0 f (x 0 )(∇ x0 f (x 0 )) T + d f d (x 0 ) ∇ 2 x0 f (x 0 ) (Σ q − Σ p * ) = −1 2σ 2 ψ l,m ∇ x0 f (x 0 )(∇ x0 f (x 0 )) T + d f d (x 0 ) ∇ 2 x0 f (x 0 ) (Σ q − Σ p * ) l,m .<label>(13)</label></formula><p xml:id="_gyfKcuJ">Lastly, we assume that both Σ q and Σ p * are diagonal and thus the element-wise multiplication with ∇ 2 x0 log p(f (x 0 )) collects only its diagonal elements:      </p><formula xml:id="formula_23" coords="17,121.28,162.42,333.52,26.88">−1 2σ 2 ψ l,m ∇ x0 f (x 0 )(∇ x0 f (x 0 )) T + d f d (x 0 ) ∇ 2 x0 f (x 0 ) (Σ q − Σ p * )</formula></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0" coords="4,108.00,436.39,396.00,8.82;4,108.00,447.53,352.87,8.64"><head>Figure 1 :</head><label>1</label><figDesc xml:id="_8JfD4vd">Figure 1: Testing Out-of-Distribution. Log-likelihood (expressed in bits per dimension) calculated from Glow (Kingma &amp; Dhariwal, 2018) on MNIST, FashionMNIST, SVHN, CIFAR-10.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1" coords="4,208.25,588.07,295.75,8.64;4,108.00,599.03,396.00,8.64;4,108.00,609.99,91.16,8.64"><head></head><label></label><figDesc xml:id="_xvb2Dcf">Figure 2 (b) shows a similar histogram of the log-likelihoods. Clearly the SVHN examples (red bars) have a systematically higher likelihood, and therefore the result is not caused by any outliers.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2" coords="5,108.00,354.50,396.00,8.64;5,107.67,365.46,324.48,8.64;5,128.38,215.07,153.30,105.39"><head></head><label></label><figDesc xml:id="_FNj3uYr">Figure 2: Histogram of Glow log-likelihoods for FashionMNIST vs MNIST (a), CIFAR-10 vs SVHN (b), CelebA vs SVHN (c), and ImageNet vs CIFAR-10 / CIFAR-100 / SVHN (d).</figDesc><graphic coords="5,128.38,215.07,153.30,105.39" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3" coords="6,108.00,345.44,396.00,8.82;6,108.00,356.58,396.00,8.64;6,108.00,367.54,206.82,8.64;6,108.49,389.96,96.05,67.28"><head></head><label></label><figDesc xml:id="_phsexCp">Figure 3: PixelCNN and VAE. Log-likelihoods calculated by PixelCNN (a, c) and VAE (b, d) on FashionMNIST vs MNIST (a, b) and CIFAR-10 vs SVHN (c, d). VAE models are the convolutional categorical variant described by Rosca et al. (2018).</figDesc><graphic coords="6,108.49,389.96,96.05,67.28" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4" coords="6,113.42,464.07,85.88,8.06;6,214.63,464.86,83.40,7.77;6,316.78,446.25,85.53,3.69;6,349.65,448.71,18.56,7.38;6,309.65,443.46,8.23,3.69;6,309.65,434.71,8.23,3.69;6,309.65,425.95,8.23,3.69;6,309.65,417.20,8.23,3.69;6,309.65,408.44,8.23,3.69;6,309.65,399.69,8.23,3.69;6,309.65,390.93,8.23,3.69;6,330.85,394.53,23.29,4.80;6,330.85,399.02,21.63,4.80;6,330.85,403.51,17.34,4.80;6,310.12,464.07,91.43,7.77;6,418.21,446.77,83.62,3.67;6,450.16,449.77,16.01,5.29;6,413.59,444.00,3.72,3.67;6,413.59,433.55,3.72,3.67;6,413.59,423.09,3.72,3.67;6,413.59,412.64,3.72,3.67;6,413.59,402.18,3.72,3.67;6,413.59,391.73,3.72,3.67;6,407.72,409.13,5.29,31.84;6,407.72,399.00,5.29,9.05;6,467.59,395.46,26.75,5.29;6,467.59,400.41,24.91,5.29;6,467.59,405.36,18.97,5.29;6,406.69,463.27,95.05,7.77"><head></head><label></label><figDesc xml:id="_JDwPHrU">(a) CIFAR-10: log p(z) (b) CIFAR-10: Volume Log-Likelihood vs Iter.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5" coords="6,108.00,484.66,396.67,8.82;6,108.00,495.44,396.00,8.99;6,108.00,506.75,396.16,8.64;6,108.00,517.71,396.00,8.64;6,107.67,528.67,396.33,8.64;6,108.00,539.63,227.88,8.64;6,210.39,389.45,92.16,68.29"><head>Figure 4 :</head><label>4</label><figDesc xml:id="_WrFkQMw">Figure 4: Decomposing the Likelihood of NVP-Glow / CV-Glow Results. The histograms in (a) and (b) show NVP-Glow's log-likelihood decomposed into contributions from the z-distribution and volume element, respectively, for CIFAR-10 vs SVHN. Subfigure (c) shows log-likelihood evaluations for constant-volume (CV) Glow, again when trained on CIFAR-10 and tested on SVHN. Subfigure (d) reports NVP-Glow's BPD over the course of training, showing that the phenomenon happens throughout and could not be prevented by early stopping.</figDesc><graphic coords="6,210.39,389.45,92.16,68.29" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6" coords="8,110.31,570.08,234.16,7.77"><head></head><label></label><figDesc xml:id="_dQZ8Wg2">(a) Histogram of per-dimension means and variances (empirical).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8" coords="8,108.00,589.87,396.00,8.82;8,108.00,600.69,384.14,8.96;8,109.92,455.15,235.22,107.81"><head>Figure 5 :</head><label>5</label><figDesc xml:id="_3MkaJVb">Figure 5: Empirical Distributions and Graying Effect. Note that pixels are converted from 0-255 scale to 0-1 scale by diving by 256. See Figure 10 for results on datasets of 28 × 28 × 1 images.</figDesc><graphic coords="8,109.92,455.15,235.22,107.81" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9" coords="13,108.00,247.88,397.74,8.64;13,108.00,258.84,396.00,8.64;13,107.67,269.80,291.50,8.64;13,142.35,109.16,156.52,111.63"><head></head><label></label><figDesc xml:id="_M8BymEc">Figure 6: Histogram of Glow log-likelihoods for MNIST vs FashionMNIST and SVHN vs CIFAR-10. Note that the model trained on SVHN (MNIST) is able to assign lower likelihood to CIFAR-10 (FashionMNIST), which illustrates the asymmetry compared to Figure 2.</figDesc><graphic coords="13,142.35,109.16,156.52,111.63" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10" coords="14,492.26,377.29,13.48,8.64;14,107.53,387.93,396.47,8.96;14,108.00,399.20,397.24,8.64;14,108.00,410.16,368.43,8.64"><head></head><label></label><figDesc xml:id="_zUNFVtp">(a). We replicated the original two dimensions to create data sets of dimensionality of up to 100. The results are shown in Figure7 (b). The empirical values of the two terms are shown by the solid lines, and indeed, we see they exhibit the expected diverging behavior as dimensionality increases.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11" coords="14,108.00,593.30,396.00,8.82;14,108.00,604.44,396.00,8.64;14,108.00,615.08,396.00,8.96;14,108.00,626.36,208.69,8.64;14,222.74,432.24,137.99,134.16"><head>Figure 7 :</head><label>7</label><figDesc xml:id="_HwGuEGt">Figure 7: Limiting Bounds. We trained an RNVP transformation on two moons data sets-which is shown in (a) for 2 dimensions-of increasing dimensionality, tracking the empirical value of each term against the upper bounds. Subfigure (b) shows Glow with an exp parametrization for the scales and (c) shows Glow with a sigmoid parametrization.</figDesc><graphic coords="14,222.74,432.24,137.99,134.16" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12" coords="16,108.00,249.39,396.00,8.82;16,108.00,260.53,396.00,8.64;16,108.00,271.48,140.60,8.64"><head>Figure 9 :</head><label>9</label><figDesc xml:id="_PCaSpk8">Figure9: Ensemble of Glows. The plot above shows a histogram of log-likelihoods computed using an ensemble of Glow models trained on CIFAR-10, tested on SVHN. Ensembles were not found to be robust against this phenomenon.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13" coords="16,203.29,488.61,48.91,9.65;16,212.27,502.18,30.45,9.65;16,256.16,495.35,7.75,8.74;16,270.33,484.94,6.69,6.12;16,266.68,509.37,14.49,6.12;16,284.99,484.77,9.49,6.79;16,283.13,509.14,13.79,6.12;16,298.88,495.35,25.36,9.65;16,337.07,488.61,5.29,8.74;16,342.91,487.04,3.97,6.12;16,347.38,488.61,43.07,9.65;16,348.28,502.18,11.54,8.74;16,359.82,500.79,3.97,6.12;16,359.82,507.23,18.91,6.12;16,394.41,495.35,15.50,8.74;16,487.40,496.02,16.60,8.64;16,107.64,528.74,396.35,8.96;16,108.00,539.67,396.00,9.68;16,108.00,552.63,143.39,9.65;16,251.39,551.06,4.71,6.12;16,260.63,552.63,39.71,8.96;16,309.75,549.66,6.69,6.12;16,309.75,557.66,14.49,6.12;16,336.91,549.66,9.49,6.79;16,336.91,557.66,13.79,6.12;16,352.86,552.63,26.47,9.65;16,379.33,551.06,3.97,6.12;16,383.80,552.95,120.19,8.64;16,108.00,566.08,8.30,8.74;16,116.30,564.51,3.97,6.12;16,116.30,570.56,8.53,6.14;16,125.83,566.08,73.97,9.65;16,107.69,583.34,327.09,8.64"><head></head><label></label><figDesc xml:id="_tVKyefC">w index the input spatial dimensions, c the input channel dimensions, k the series of flows, and j the column dimensions of theC k × C k -sized convolutional kernel U k . The diagonal elements of ∇ x0 f (x 0 )(∇ x0 f (x 0 )) T are then ( u k,c,j ) 2 ,and the diagonal element of ∇ 2 x0 f (x 0 ) are all zero. Then returning to the full equation, for the constant-volume Glow model we have:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14" coords="17,462.83,184.68,12.00,6.12;17,122.85,210.44,7.75,8.74;17,136.93,203.70,12.73,8.74;17,134.56,217.27,10.67,8.74;17,145.59,215.88,3.97,6.12;17,145.24,222.30,6.03,6.14;17,158.54,200.03,6.52,6.12;17,159.74,224.46,4.66,6.12;17,173.84,200.03,7.49,6.12;17,175.15,223.94,5.76,6.12;17,191.07,200.03,5.71,6.12;17,192.39,223.94,3.56,6.12;17,203.03,196.82,8.72,6.38;17,203.03,214.75,8.72,6.38;17,215.40,200.03,6.69,6.12;17,211.75,224.46,14.49,6.12;17,230.06,199.85,9.49,6.79;17,228.20,224.23,13.79,6.12;17,243.95,210.44,21.69,9.65;17,266.54,196.82,8.72,6.38;17,266.54,214.75,8.72,6.38;17,275.26,194.52,3.97,6.12;17,281.39,210.44,9.57,8.74;17,291.32,208.37,3.97,6.12;17,290.96,214.94,25.18,6.12;17,318.85,210.44,15.66,8.74;17,334.86,208.37,3.97,6.12;17,334.50,214.31,29.55,6.75;17,364.55,210.44,3.87,8.74;17,122.85,252.32,7.75,8.74;17,136.93,245.58,12.73,8.74;17,134.56,259.15,10.67,8.74;17,145.59,257.76,3.97,6.12;17,145.24,264.18,6.03,6.14;17,158.97,241.91,5.71,6.12;17,160.29,265.82,3.56,6.12;17,170.93,238.70,8.72,6.38;17,170.93,256.63,8.72,6.38;17,183.30,241.91,6.69,6.12;17,179.64,266.34,14.49,6.12;17,197.96,241.74,9.49,6.79;17,196.10,266.12,13.79,6.12;17,211.85,252.32,21.69,9.65;17,234.44,238.70,8.72,6.38;17,234.44,256.63,8.72,6.38;17,243.16,236.40,3.97,6.12;17,252.96,241.91,6.52,6.12;17,254.15,266.34,4.66,6.12;17,268.25,241.91,7.49,6.12;17,269.56,265.82,5.76,6.12;17,279.73,252.32,9.57,8.74;17,289.66,250.25,3.97,6.12;17,289.30,256.82,25.18,6.12;17,317.19,252.32,15.66,8.74;17,333.20,250.25,3.97,6.12;17,332.84,256.19,29.55,6.75;17,362.89,252.32,3.87,8.74;17,487.40,212.56,16.60,8.64;17,107.64,326.13,364.53,8.64;17,108.30,402.46,190.37,10.37;17,165.24,660.54,281.23,8.06"><head></head><label></label><figDesc xml:id="_cJDWpqJ">at the last line by rearranging the sum to collect the shared channel terms. H HISTOGRAM OF DATA STATISTICS (a) Datasets of 28 × 28 × 1 images: MNIST, FashionMNIST and NotMNIST.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15" coords="17,108.00,682.59,337.44,9.65;17,451.38,680.71,3.97,6.12;17,449.84,688.06,6.31,6.12;17,142.75,502.60,326.50,151.12"><head>Figure 10 :</head><label>10</label><figDesc xml:id="_MaFb7jS">Figure 10: Data statistics: Histogram of per-dimensional mean, computed as µ d = 1 N</figDesc><graphic coords="17,142.75,502.60,326.50,151.12" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16" coords="18,117.84,198.90,111.81,6.25;18,115.28,194.18,2.53,6.25;18,115.28,180.29,2.53,6.25;18,115.28,166.39,2.53,6.25;18,115.28,152.50,2.53,6.25;18,115.28,138.61,2.53,6.25;18,112.75,124.71,5.07,6.25;18,112.75,110.82,5.07,6.25;18,112.75,96.93,5.07,6.25;18,112.75,83.03,5.07,6.25;18,203.38,88.54,11.23,6.25;18,203.38,94.39,18.25,6.25;18,242.97,198.90,110.94,6.25;18,240.81,194.18,2.53,6.25;18,240.81,178.30,2.53,6.25;18,240.81,162.42,2.53,6.25;18,240.81,146.55,2.53,6.25;18,240.81,130.67,2.53,6.25;18,238.28,114.79,5.07,6.25;18,238.28,98.91,5.07,6.25;18,238.28,83.03,5.07,6.25;18,328.91,88.54,11.23,6.25;18,328.91,94.39,18.25,6.25;18,368.50,198.90,6.33,6.25;18,394.65,198.90,6.33,6.25;18,420.80,198.90,6.33,6.25;18,446.96,198.90,6.33,6.25;18,473.11,198.90,6.33,6.25;18,362.54,194.18,6.33,6.25;18,362.54,180.29,6.33,6.25;18,362.54,166.39,6.33,6.25;18,362.54,152.50,6.33,6.25;18,362.54,138.61,6.33,6.25;18,362.54,124.71,6.33,6.25;18,362.54,110.82,6.33,6.25;18,362.54,96.93,6.33,6.25;18,362.54,83.03,6.33,6.25;18,454.44,88.54,11.23,6.25;18,454.44,94.39,18.25,6.25;18,188.29,214.43,215.33,7.77;18,121.94,341.43,108.75,6.81;18,112.72,335.38,6.90,6.81;18,112.72,317.03,6.90,6.81;18,112.72,298.67,6.90,6.81;18,112.72,280.31,6.90,6.81;18,112.72,261.96,6.90,6.81;18,112.72,243.60,6.90,6.81;18,112.72,225.25,6.90,6.81;18,186.62,231.63,16.18,8.05;18,186.62,239.16,36.02,8.05;18,244.52,341.43,110.56,6.81;18,241.26,335.38,2.76,6.81;18,241.26,319.65,2.76,6.81;18,241.26,303.92,2.76,6.81;18,241.26,288.18,2.76,6.81;18,241.26,272.45,2.76,6.81;18,238.50,256.71,5.52,6.81;18,238.50,240.98,5.52,6.81;18,238.50,225.25,5.52,6.81;18,311.01,231.63,16.18,8.05;18,311.01,239.16,36.02,8.05;18,368.91,341.43,110.56,6.81;18,361.50,335.38,6.90,6.81;18,361.50,319.65,6.90,6.81;18,361.50,303.92,6.90,6.81;18,361.50,288.18,6.90,6.81;18,361.50,272.45,6.90,6.81;18,361.50,256.71,6.90,6.81;18,361.50,240.98,6.90,6.81;18,361.50,225.25,6.90,6.81;18,435.40,231.63,16.18,8.05;18,435.40,239.16,36.02,8.05;18,167.08,357.43,257.74,7.77"><head></head><label></label><figDesc xml:id="_4upTaTD">Latent codes for FashionMNIST-MNIST trained on FashionMNIST.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17" coords="18,108.00,377.41,396.67,8.64;18,108.00,392.81,21.16,9.65;18,134.67,390.93,3.97,6.12;18,133.13,398.29,6.31,6.12"><head>Figure 11 :</head><label>11</label><figDesc xml:id="_FveUq99">Figure 11: Analysis of codes obtained using CV-Glow model. Histogram of means (left column) µ d = 1 N</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18" coords="18,111.84,720.09,388.33,8.64"><head>Figure 12 :</head><label>12</label><figDesc xml:id="_xMjHA5F">Figure 12: Effect of graying on codes. Left (mean), middle (standard deviation) and norm (right).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19" coords="19,164.76,481.43,282.48,8.82;19,148.32,294.78,151.98,151.64"><head>Figure 13 :</head><label>13</label><figDesc xml:id="_wf7eGhY">Figure 13: Samples. Samples from CV-Glow models used for analysis.</figDesc><graphic coords="19,148.32,294.78,151.98,151.64" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" coords="4,113.98,305.09,392.91,115.69"><head></head><label></label><figDesc xml:id="_cb2teKC">in the Appendix.</figDesc><table coords="4,113.98,327.80,392.91,92.98"><row><cell>Data Set</cell><cell>Avg. Bits Per Dimension</cell><cell>Data Set</cell><cell>Avg. Bits Per Dimension</cell></row><row><cell cols="2">Glow Trained on FashionMNIST</cell><cell cols="2">Glow Trained on CIFAR-10</cell></row><row><cell>FashionMNIST-Train</cell><cell>2.902</cell><cell>CIFAR10-Train</cell><cell>3.386</cell></row><row><cell>FashionMNIST-Test</cell><cell>2.958</cell><cell>CIFAR10-Test</cell><cell>3.464</cell></row><row><cell>MNIST-Test</cell><cell>1.833</cell><cell>SVHN-Test</cell><cell>2.389</cell></row><row><cell cols="2">Glow Trained on MNIST</cell><cell cols="2">Glow Trained on SVHN</cell></row><row><cell>MNIST-Test</cell><cell>1.262</cell><cell>SVHN-Test</cell><cell>2.057</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0">Although we use a smaller model, it still produces good samples, which can be seen in Figure13of the Appendix, and competitive BPD (CIFAR-10: 3.46 for ours vs 3.35 for theirs).</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_1"> See Theis et al. (2016, Section  </note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_2">.1) for the definitions of log-likelihood and bits-per-dimension.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_3">It is easy to show the upper bound via Hadamard's inequality: det ∂f /∂x ≤ ||∂f /∂x|| F .</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4" xml:id="foot_4">https://github.com/openai/glow/blob/master/model.py#L376</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head xml:id="_U3y3dzE">ACKNOWLEDGMENTS</head><p xml:id="_vRrpfrN">We thank Aaron van den Oord, Danilo Rezende, Eric Jang, Florian Stimberg, Josh Dillon, Mihaela Rosca, Rui Shu, Sander Dieleman, and the anonymous reviewers for their helpful feedback and discussions.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct coords="10,108.00,102.71,397.75,8.82;10,117.79,113.67,211.87,8.82" xml:id="b0">
	<analytic>
		<title level="a" type="main" xml:id="_XT7MPMA">Novelty Detection and Neural Network Validation. IEE Proceedings-Vision</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Christopher</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Bishop</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_SHqjumT">Image and Signal processing</title>
		<imprint>
			<biblScope unit="volume">141</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="217" to="222" />
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,132.31,396.00,8.82;10,117.63,143.27,138.65,8.82" xml:id="b1">
	<analytic>
		<title level="a" type="main" xml:id="_59tSuTQ">Training with Noise is Equivalent to Tikhonov Regularization</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Christopher</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Bishop</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_JY9S9ST">Neural Computation</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="108" to="116" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,162.09,397.74,8.64;10,117.36,172.87,387.84,8.82;10,117.66,184.01,199.65,8.64" xml:id="b2">
	<monogr>
		<title level="m" type="main" xml:id="_r82PQU3">Panel Discussion. Advances in Approximate Bayesian Inference</title>
		<author>
			<persName coords=""><forename type="first">David</forename><surname>Blei</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Katherine</forename><surname>Heller</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Tim</forename><surname>Salimans</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Max</forename><surname>Welling</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Zoubin</forename><surname>Ghahramani</surname></persName>
		</author>
		<ptr target="https://youtu.be/x1UByHT60mQ?t=46m2s.NeurIPSWorkshop" />
		<imprint>
			<date type="published" when="2017-12">December 2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,202.48,396.00,8.82;10,117.96,213.43,100.17,8.82" xml:id="b3">
	<monogr>
		<title level="m" type="main" xml:id="_DYReDWU">Generative Ensembles for Robust Anomaly Detection</title>
		<author>
			<persName coords=""><forename type="first">Hyunsun</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Eric</forename><surname>Jang</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1810.01392</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note type="report_type">ArXiv e-Print</note>
</biblStruct>

<biblStruct coords="10,108.00,232.25,396.00,8.64;10,117.96,243.03,165.05,8.82" xml:id="b4">
	<monogr>
		<title level="m" type="main" xml:id="_Pv6bBt5">NICE: Non-Linear Independent Components Estimation</title>
		<author>
			<persName coords=""><forename type="first">Laurent</forename><surname>Dinh</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">David</forename><surname>Krueger</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2015">2015</date>
			<publisher>ICLR Workshop Track</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,261.86,395.99,8.64;10,117.79,272.64,276.54,8.82" xml:id="b5">
	<analytic>
		<title level="a" type="main" xml:id="_GRFdnYd">Density Estimation Using Real NVP</title>
		<author>
			<persName coords=""><forename type="first">Laurent</forename><surname>Dinh</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Jascha</forename><surname>Sohl-Dickstein</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Samy</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_d3HqNCT">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,291.46,396.00,8.64;10,117.60,302.24,228.41,8.82" xml:id="b6">
	<analytic>
		<title level="a" type="main" xml:id="_JZzRfne">Regularization Theory and Neural Networks Architectures</title>
		<author>
			<persName coords=""><forename type="first">Federico</forename><surname>Girosi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Michael</forename><surname>Jones</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Tomaso</forename><surname>Poggio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_7GECQWV">Neural Computation</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="219" to="269" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,321.06,397.25,8.64;10,117.60,331.84,386.39,8.82;10,117.79,342.80,198.78,8.82" xml:id="b7">
	<analytic>
		<title level="a" type="main" xml:id="_EqXc2vn">Generative Adversarial Nets</title>
		<author>
			<persName coords=""><forename type="first">Ian</forename><surname>Goodfellow</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Jean</forename><surname>Pouget-Abadie</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Mehdi</forename><surname>Mirza</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Bing</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">David</forename><surname>Warde-Farley</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Sherjil</forename><surname>Ozair</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Aäron</forename><surname>Courville</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_MJ4Z8DM">Advances in Neural Information Processing Systems (NeurIPS)</title>
				<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,361.62,396.00,8.64;10,117.96,372.40,387.28,8.82;10,117.96,383.53,22.42,8.64" xml:id="b8">
	<analytic>
		<title level="a" type="main" xml:id="_r64kGsF">A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks</title>
		<author>
			<persName coords=""><forename type="first">Dan</forename><surname>Hendrycks</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Kevin</forename><surname>Gimpel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_V47wad5">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,402.18,396.17,8.64;10,117.96,412.96,331.03,8.82" xml:id="b9">
	<analytic>
		<title level="a" type="main" xml:id="_NncjFuM">Deep Anomaly Detection with Outlier Exposure</title>
		<author>
			<persName coords=""><forename type="first">Dan</forename><surname>Hendrycks</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Mantas</forename><surname>Mazeika</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Thomas</forename><surname>Dietterich</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_TvBMzhx">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,431.60,396.00,8.82;10,117.71,442.56,127.58,8.82" xml:id="b10">
	<analytic>
		<title level="a" type="main" xml:id="_pR5ug5T">Classification with Reject Option</title>
		<author>
			<persName coords=""><forename type="first">Radu</forename><surname>Herbei</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Marten</forename><forename type="middle">H</forename><surname>Wegkamp</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_2YXq2YA">Canadian Journal of Statistics</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="709" to="721" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,461.38,397.74,8.64;10,117.96,472.16,290.50,8.82" xml:id="b11">
	<analytic>
		<title level="a" type="main" xml:id="_p235bRz">Glow: Generative Flow with Invertible 1x1 Convolutions</title>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Prafulla</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Dhariwal</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_baEvUK2">Advances in Neural Information Processing Systems (NeurIPS)</title>
				<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,490.80,396.00,8.82;10,117.96,501.76,173.42,8.82" xml:id="b12">
	<analytic>
		<title level="a" type="main" xml:id="_C3GSQye">Auto-Encoding Variational Bayes</title>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Max</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_JAqSd9R">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,520.40,396.00,8.82;10,117.79,531.36,280.75,8.82" xml:id="b13">
	<analytic>
		<title level="a" type="main" xml:id="_fxJ2ffS">Adversarial Examples for Generative Models</title>
		<author>
			<persName coords=""><forename type="first">Jernej</forename><surname>Kos</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Ian</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Dawn</forename><surname>Song</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_yJKPKNT">2018 IEEE Security and Privacy Workshops (SPW)</title>
				<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="36" to="42" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,550.18,397.74,8.64;10,117.65,561.14,183.49,8.64" xml:id="b14">
	<monogr>
		<title level="m" type="main" xml:id="_HUJ4VJe">Learning Multiple Layers of Features from Tiny Images</title>
		<author>
			<persName coords=""><forename type="first">Alex</forename><surname>Krizhevsky</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Geoffrey</forename><surname>Hinton</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
		</imprint>
		<respStmt>
			<orgName>University of Toronto</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct coords="10,108.00,579.78,396.00,8.64;10,117.96,590.56,386.04,8.82;10,117.71,601.52,102.37,8.82" xml:id="b15">
	<analytic>
		<title level="a" type="main" xml:id="_7P6JqEv">Simple and Scalable Predictive Uncertainty Estimation Using Deep Ensembles</title>
		<author>
			<persName coords=""><forename type="first">Alexander</forename><surname>Balaji Lakshminarayanan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Charles</forename><surname>Pritzel</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Blundell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_SDWGsUy">Advances in Neural Information Processing Systems (NeurIPS)</title>
				<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,620.34,396.17,8.64;10,117.96,631.12,386.03,8.82;10,117.30,642.08,55.62,8.82" xml:id="b16">
	<analytic>
		<title level="a" type="main" xml:id="_UJ9auvC">Training Confidence-Calibrated Classifiers for Detecting Out-of-Distribution Samples</title>
		<author>
			<persName coords=""><forename type="first">Kimin</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Honglak</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Kibok</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Jinwoo</forename><surname>Shin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_tscek6v">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="10,108.00,660.90,396.00,8.64;10,117.96,671.68,387.28,8.82;10,117.96,682.82,22.42,8.64;10,108.00,701.46,396.00,8.64;10,117.96,712.24,386.03,8.82;10,117.30,723.20,57.83,8.82" xml:id="b17">
	<analytic>
		<title level="a" type="main" xml:id="_w8SUN6v">Christos Louizos and Max Welling. Multiplicative Normalizing Flows for Variational Bayesian Neural Networks</title>
		<author>
			<persName coords=""><forename type="first">Shiyu</forename><surname>Liang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Yixuan</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Srikant</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_m9J5xwd">Neural Networks. International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2017">2018. 2017</date>
		</imprint>
	</monogr>
	<note>Proceedings of the 34th International Conference on Machine Learning (ICML)</note>
</biblStruct>

<biblStruct coords="11,108.00,85.34,396.00,8.64;11,117.96,96.12,386.03,8.82;11,117.68,107.08,210.58,8.82" xml:id="b18">
	<analytic>
		<title level="a" type="main" xml:id="_hK93P2Y">Reading Digits in Natural Images with Unsupervised Feature Learning</title>
		<author>
			<persName coords=""><forename type="first">Yuval</forename><surname>Netzer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Tao</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Adam</forename><surname>Coates</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Alessandro</forename><surname>Bissacco</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Bo</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Andrew</forename><forename type="middle">Y</forename><surname>Ng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_Uk8VVNx">NeurIPS Workshop on Deep Learning and Unsupervised Feature Learning</title>
				<imprint>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,126.19,396.00,8.64;11,117.96,136.97,386.04,8.82;11,117.54,147.92,198.81,8.82" xml:id="b19">
	<analytic>
		<title level="a" type="main" xml:id="_jHHAJ5r">Stochastic Backpropagation and Approximate Inference in Deep Generative Models</title>
		<author>
			<persName coords=""><forename type="first">Danilo</forename><surname>Rezende</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Shakir</forename><surname>Mohamed</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Daan</forename><surname>Wierstra</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_W7FUKKD">Proceedings of the 31st International Conference on Machine Learning (ICML)</title>
				<meeting>the 31st International Conference on Machine Learning (ICML)</meeting>
		<imprint>
			<date type="published" when="2014">2014</date>
			<biblScope unit="page" from="1278" to="1286" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,167.03,397.65,8.64;11,117.96,177.81,386.04,8.82;11,117.63,188.77,194.56,8.82" xml:id="b20">
	<analytic>
		<title level="a" type="main" xml:id="_2Nmx7rn">Contractive Auto-Encoders: Explicit Invariance During Feature Extraction</title>
		<author>
			<persName coords=""><forename type="first">Salah</forename><surname>Rifai</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Pascal</forename><surname>Vincent</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Xavier</forename><surname>Muller</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Xavier</forename><surname>Glorot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_YsNGNXs">Proceedings of the 28th International Conference on Machine Learning (ICML)</title>
				<meeting>the 28th International Conference on Machine Learning (ICML)</meeting>
		<imprint>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,207.88,396.00,8.64;11,117.96,218.66,199.76,8.82" xml:id="b21">
	<monogr>
		<title level="m" type="main" xml:id="_U8sq3VH">Distribution matching in variational inference</title>
		<author>
			<persName coords=""><forename type="first">Mihaela</forename><surname>Rosca</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Balaji</forename><surname>Lakshminarayanan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Shakir</forename><surname>Mohamed</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1802.06847</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note type="report_type">ArXiv e-Print</note>
</biblStruct>

<biblStruct coords="11,108.00,237.77,396.44,8.64;11,117.60,248.55,356.32,8.82" xml:id="b22">
	<analytic>
		<title level="a" type="main" xml:id="_sdvKtrq">Does Your Model Know the Digit 6 Is Not a Cat? A Less Biased Evaluation of</title>
		<author>
			<persName coords=""><forename type="first">Alireza</forename><surname>Shafaei</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Mark</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">James</forename><forename type="middle">J</forename><surname>Little</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1809.04729</idno>
	</analytic>
	<monogr>
		<title level="j" xml:id="_vqSbuvF">Outlier&quot; Detectors. ArXiv e-Print</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,267.66,395.99,8.64;11,117.65,278.44,348.79,8.82" xml:id="b23">
	<analytic>
		<title level="a" type="main" xml:id="_tFanhST">Are Generative Deep Models for Novelty Detection Truly Better?</title>
		<author>
			<persName coords=""><forename type="first">Vít</forename><surname>Škvára</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Tomáš</forename><surname>Pevnỳ</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Václav</forename><surname>Šmídl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_6Az7TxY">KDD Workshop on Outlier Detection De-Constructed</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note>ODD v5.0)</note>
</biblStruct>

<biblStruct coords="11,108.00,297.54,396.00,8.64;11,117.96,308.32,386.04,8.82;11,117.30,319.28,55.62,8.82" xml:id="b24">
	<monogr>
		<author>
			<persName coords=""><forename type="first">Jose</forename><surname>Casper Kaae Sønderby</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Lucas</forename><surname>Caballero</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Wenzhe</forename><surname>Theis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Ferenc</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Huszár</surname></persName>
		</author>
		<title level="m" xml:id="_88SyGz7">Amortised MAP Inference for Image Super-Resolution. International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,338.39,397.24,8.64;11,117.96,349.17,386.04,8.82;11,117.65,360.13,121.94,8.82" xml:id="b25">
	<monogr>
		<author>
			<persName coords=""><forename type="first">Christian</forename><surname>Szegedy</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Wojciech</forename><surname>Zaremba</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Ilya</forename><surname>Sutskever</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Joan</forename><surname>Bruna</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Dumitru</forename><surname>Erhan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Ian</forename><surname>Goodfellow</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Rob</forename><surname>Fergus</surname></persName>
		</author>
		<title level="m" xml:id="_k6cTTh6">Intriguing Properties of Neural Networks. International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,379.24,396.00,8.64;11,117.36,390.02,279.71,8.82" xml:id="b26">
	<analytic>
		<title level="a" type="main" xml:id="_edX5K59">Information Regularization with Partially Labeled Data</title>
		<author>
			<persName coords=""><forename type="first">Martin</forename><surname>Szummer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Tommi</forename><forename type="middle">S</forename><surname>Jaakkola</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_4BrafA8">Advances in Neural Information Processing Systems (NeurIPS)</title>
				<imprint>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,409.12,397.74,8.64;11,117.36,419.90,81.35,8.82" xml:id="b27">
	<monogr>
		<title level="m" type="main" xml:id="_TJH5Hzw">Adversarial Images for Variational Autoencoders</title>
		<author>
			<persName coords=""><forename type="first">Pedro</forename><surname>Tabacof</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Julia</forename><surname>Tavares</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Eduardo</forename><surname>Valle</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
	<note type="report_type">Print</note>
</biblStruct>

<biblStruct coords="11,108.00,439.01,397.74,8.64;11,117.63,449.79,297.94,8.82" xml:id="b28">
	<analytic>
		<title level="a" type="main" xml:id="_n9uvFGD">A Family of Nonparametric Density Estimation Algorithms</title>
		<author>
			<persName coords=""><forename type="first">Cristina</forename><forename type="middle">V</forename><surname>Eg Tabak</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Turner</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" xml:id="_eMRbUWz">Communications on Pure and Applied Mathematics</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="145" to="164" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,468.90,396.00,8.64;11,117.96,479.68,323.29,8.82" xml:id="b29">
	<analytic>
		<title level="a" type="main" xml:id="_WN3r86H">A Note on the Evaluation of Generative Models</title>
		<author>
			<persName coords=""><forename type="first">Lucas</forename><surname>Theis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Aäron</forename><surname>Van Den Oord</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Matthias</forename><surname>Bethge</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_Cu5T6Ja">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,498.79,397.25,8.64;11,117.96,509.75,386.20,8.64;11,117.96,520.53,137.36,8.82" xml:id="b30">
	<monogr>
		<title level="m" type="main" xml:id="_2cUcXpa">Wavenet: A Generative Model for Raw Audio</title>
		<author>
			<persName coords=""><forename type="first">Aäron</forename><surname>Van Den Oord</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Sander</forename><surname>Dieleman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Heiga</forename><surname>Zen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Karen</forename><surname>Simonyan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Oriol</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Alex</forename><surname>Graves</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Nal</forename><surname>Kalchbrenner</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Andrew</forename><surname>Senior</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Koray</forename><surname>Kavukcuoglu</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2016">2016a</date>
		</imprint>
	</monogr>
	<note type="report_type">Print</note>
</biblStruct>

<biblStruct coords="11,108.00,539.64,396.00,8.64;11,117.96,550.42,386.04,8.82;11,117.30,561.37,73.32,8.82" xml:id="b31">
	<analytic>
		<title level="a" type="main" xml:id="_sfeWxBj">Conditional image generation with pixel CNN decoders</title>
		<author>
			<persName coords=""><forename type="first">Aäron</forename><surname>Van Den Oord</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Nal</forename><surname>Kalchbrenner</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Lasse</forename><surname>Espeholt</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Oriol</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Alex</forename><surname>Graves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_t6HajN9">Advances in Neural Information Processing Systems (NeurIPS)</title>
				<imprint>
			<date type="published" when="2016">2016b</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="11,108.00,580.48,397.24,8.64;11,117.96,591.44,387.29,8.64;11,117.96,602.40,386.29,8.64;11,117.96,613.36,386.04,8.64;11,117.96,624.14,386.04,8.82;11,117.68,635.10,161.61,8.82" xml:id="b32">
	<analytic>
		<title level="a" type="main" xml:id="_nRx3nt3">Dan Belov, and Demis Hassabis. Parallel WaveNet: Fast high-fidelity speech synthesis</title>
		<author>
			<persName coords=""><forename type="first">Aaron</forename><surname>Van Den Oord</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Yazhe</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Igor</forename><surname>Babuschkin</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Karen</forename><surname>Simonyan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Oriol</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Koray</forename><surname>Kavukcuoglu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">George</forename><surname>Van Den Driessche</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Edward</forename><surname>Lockhart</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Luis</forename><surname>Cobo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Florian</forename><surname>Stimberg</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Norman</forename><surname>Casagrande</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Dominik</forename><surname>Grewe</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Seb</forename><surname>Noury</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Sander</forename><surname>Dieleman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Erich</forename><surname>Elsen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Nal</forename><surname>Kalchbrenner</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Heiga</forename><surname>Zen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" xml:id="_zTER6c9">Proceedings of the 35th International Conference on Machine Learning (ICML)</title>
				<meeting>the 35th International Conference on Machine Learning (ICML)<address><addrLine>Alex Graves, Helen King, Tom Walters</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="3918" to="3926" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
